@layer components {
  .prose {
    text-wrap: pretty;
    font-variant-numeric: oldstyle-nums proportional-nums;
    -webkit-hyphens: auto;
    -webkit-hyphenate-limit-before: 4;
    -webkit-hyphenate-limit-after: 3;
    -webkit-hyphenate-limit-lines: 2;

    hyphens: auto;
    hyphenate-limit-chars: 7 4 3;
    hyphenate-limit-lines: 2;
    hyphenate-limit-zone: 8%;
    hyphenate-limit-last: always;

    pre,
    code,
    var,
    samp,
    kbd,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      -webkit-hyphens: manual;
      hyphens: manual;
    }
    
    /*
    * Paragraphs
    * Modern text-wrap for better typography (Chrome 117+, Safari 17.5+)
    */
    p {
      max-inline-size: var(--measure);
      text-wrap: pretty; /* Reduces orphans automatically */
      margin-block-end: var(--line-05);
    }
      /* 
      From Liam Johnson: Vertical Spacing in Long-Form Text:
      Non-heading elements should have a big gap after them if followed by a heading.
      Star selector means that a bunch of stuff should "just work",
      e.g. if you insert images or other elements between text nodes.
      But you could change the `*` to `:is(h1,h2,h3,h4,h5,h6)` if you don't want that. 

      - https://css-tricks.com/solved-with-has-vertical-spacing-in-long-form-text/
    */
    *:has(+ h2) {
      margin-block-end: var(--line-2);
    }
    *:has(+ h3) {
      margin-block-end: var(--line-2);
    }
    *:has(+ h4) {
      margin-block-end: var(--line-15);
    }
    *:has(+ h5) {
      margin-block-end: var(--line-1);
    }
    *:has(+ h6) {
      margin-block-end: var(--line-1);
    }

    /* Headings followed immediately by a heading of a level down
      should have only a small gap below.
      Using :where() for consistent specificity.
    */
    :where(h1):has(+ h2) {
      margin-block-end: var(--line-025);
    }
    :where(h2):has(+ h3) {
      margin-block-end: var(--line-025);
    }
    :where(h3):has(+ h4) {
      margin-block-end: var(--line-025);
    }
    :where(h4):has(+ h5) {
      margin-block-end: var(--line-025);
    }
    :where(h5):has(+ h6) {
      margin-block-end: var(--line-025);
    }

    /* List item spacing. */
    :where(li):has(+ li) {
      margin-block-end: 0;
    }
    /* Nested list spacing. */
    :where(li) :is(ul, ol) {
      margin-block-start: var(--line-025);
    }
  }
  .lead {
    font-size: var(--text-lg);
    line-height: var(--line-height-lg);
    letter-spacing: var(--tracking-lg);
  }
  .price:first-letter,
  .cents {
    display: inline-block;
    height: 0;
    line-height: 1.5;
    vertical-align: top;
    position: relative;
    font-size: 0.66667em;
    bottom: .5ex;
  }
  .cents {
    bottom: .15ex;
  }
  .prose > * + *,
  .flow > * + * {
    margin-block-start: var(--line-05);
  }
}

